<div id="results" aria-live="polite">
  <!-- Skeleton loader -->
  <template x-if="loading && results.length === 0">
    <div class="skeleton-loader">
      <template x-for="i in 3">
        <div class="skeleton-card">
          <div class="skeleton-header">
            <div class="skeleton-avatar"></div>
            <div class="skeleton-title"></div>
          </div>
          <div class="skeleton-body">
            <div class="skeleton-line"></div>
            <div class="skeleton-line short"></div>
          </div>
        </div>
      </template>
    </div>
  </template>

  <!-- Empty state -->
  <template x-if="!loading && results.length === 0 && searched && !error">
    <div class="empty-state">
      <div class="empty-icon">
        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <circle cx="11" cy="11" r="8"></circle>
          <path d="m21 21-4.35-4.35"></path>
          <line x1="8" y1="8" x2="14" y2="14"></line>
          <line x1="14" y1="8" x2="8" y2="14"></line>
        </svg>
      </div>
      <p class="empty-message" id="no-results-i18n" data-i18n="no_results"></p>
      <p class="empty-suggestion">Try adjusting your search radius or fuel type</p>
    </div>
  </template>

  <!-- Results -->
  <template x-if="results.length > 0">
    <section class="results-layout" aria-labelledby="results-heading">
      <h2 id="results-heading" class="sr-only" data-i18n="results_heading"></h2>

      <!-- Station Cards List -->
      <div id="results-container">
        <template x-for="(station, index) in results" :key="station.id || index">
          <article
            class="station-card"
            :class="{ 'best-price': isCheapestStation(index) }"
            @keyup.enter="selectStationForMap(index)"
            tabindex="0"
            :aria-label="(station.gestore || (typeof t !== 'undefined' ? t('translation.station', 'Gas Station') : 'Gas Station')) + ', ' + formatCurrency(station.fuel_prices?.[0]?.price || 0)"
          >
            <div class="station-card-header">
              <div class="station-brand">
                <div class="station-icon">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                    <path d="M2 17l10 5 10-5"></path>
                    <path d="M2 12l10 5 10-5"></path>
                  </svg>
                </div>
                <span x-text="station.gestore || translate('translation.station', 'Gas Station')"></span>
              </div>
              <div class="station-price" aria-label="Price">
                <!-- Best Price Badge - now inline with price -->
                <template x-if="isCheapestStation(index)">
                  <span
                    class="best-price-badge-inline"
                    x-text="translate('translation.best_price', 'Best Price!')"
                  ></span>
                </template>
                <template x-if="station.fuel_prices && station.fuel_prices.length > 0">
                  <span class="price-large" x-text="formatCurrency(station.fuel_prices[0].price)"></span>
                </template>
                <template x-if="station.fuel_prices && station.fuel_prices.length > 0">
                  <span class="price-fuel" x-text="station.fuel_prices[0].type"></span>
                </template>
              </div>
            </div>

            <div class="station-card-body">
              <div class="station-address-row">
                <svg
                  class="address-icon"
                  width="18"
                  height="18"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                  <circle cx="12" cy="10" r="3"></circle>
                </svg>
                <span class="station-address" x-text="station.address"></span>
              </div>

              <div class="station-meta-row">
                <span class="fuel-badge">
                  <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                    <path d="M2 17l10 5 10-5"></path>
                    <path d="M2 12l10 5 10-5"></path>
                  </svg>
                  <span x-text="translate('translation.' + formData.fuel, formData.fuel)"></span>
                </span>
                <template x-if="station.distance"><span class="distance-badge">
                  <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <polyline points="12 6 12 12 16 14"></polyline>
                  </svg>
                  <span x-text="station.distance + ' km'"></span>
                </span></template>
              </div>

              <div class="station-actions">
                <button
                  class="btn btn-primary"
                  @click="getDirections(station)"
                  :aria-label="'Get directions to ' + (station.gestore || (typeof t !== 'undefined' ? t('translation.station', 'Gas Station') : 'Gas Station'))"
                >
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 18l6-6-6-6"></path>
                  </svg>
                  <span x-text="translate('translation.navigate', 'Navigate')"></span>
                </button>
                <button
                  class="btn btn-secondary"
                  @click="selectStationForMap(index)"
                  :aria-label="'Show ' + (station.gestore || (typeof t !== 'undefined' ? t('translation.station', 'Gas Station') : 'Gas Station')) + ' on map'"
                >
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                    <circle cx="12" cy="10" r="3"></circle>
                  </svg>
                  <span x-text="translate('translation.show_on_map', 'Show on Map')"></span>
                </button>
              </div>
            </div>
          </article>
        </template>
      </div>
    </section>
  </template>

  <!-- Error Message -->
  <template x-if="error">
    <div class="error-message" role="alert">
      <svg
        width="20"
        height="20"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        style="margin-right: 8px; vertical-align: middle;"
      >
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="12" y1="8" x2="12" y2="12"></line>
        <line x1="12" y1="16" x2="12.01" y2="16"></line>
      </svg>
      <span x-text="error"></span>
    </div>
  </template>
</div>
